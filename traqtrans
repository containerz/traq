#!/usr/bin/env bash
# convert the output of a traq file
# <date>;tag
# will become
# <timestamp>;tag

set +e

. $TRAQ_PATH/traqtrans_helper.sh

FILE="$@"
if [ "$FILE" != "" ]; then
  exec<$FILE
fi

separator() {
  printf "%%%%\n"
}

while read LINE
do
  if [ "$LINE" != "%%" ]
  then
    printf "$(date2timestamp "$(extract_date "$LINE")");$(extract_tag $LINE)\n"
  else
    separator
  fi
done

if [ "$FILE" != "" ]; then
  separator
fi